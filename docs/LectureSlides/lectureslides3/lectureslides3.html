<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>STAT 302, Week 3</title>
    <meta charset="utf-8" />
    <meta name="author" content="Bryan Martin" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, top, title-slide

# STAT 302, Week 3
## Data Visualization and Manipulation
### Bryan Martin
### Week of Jan 20, 2020

---





# Outline

1. Introduction to tidyverse
2. Data Visualization
3. Data Manipulation

.middler[**Goal:** Learn how to go from raw data to exploratory data analysis. (Project 1!)]

---
class: inverse

.sectionhead[Part 1: Introduction to tidyverse]
---
layout: true

# tidyverse
---

The `tidyverse` is a collection of powerful R packages for data science. 
They include:

* Reading and saving data: `readr`
* Data manipulation: `tidyr`, `dplyr`
* Data visualization: `ggplot2`
* Working with different data structures: `tibble`, `purrr`, `stringr`, `forcats`

You can install them all using


```r
install.packages("tidyverse")
```

(Remember, you only need to do this once!)

---

Load them all together in your workflow documents by calling


```r
library(tidyverse)
```

```
## ── Attaching packages ───────────────── tidyverse 1.3.0 ──
```

```
## ✓ ggplot2 3.2.1     ✓ purrr   0.3.3
## ✓ tibble  2.1.3     ✓ dplyr   0.8.3
## ✓ tidyr   1.0.0     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.4.0
```

```
## ── Conflicts ──────────────────── tidyverse_conflicts() ──
## x dplyr::filter()     masks stats::filter()
## x dplyr::group_rows() masks kableExtra::group_rows()
## x dplyr::lag()        masks stats::lag()
```

---

## Conflicts?

Recall that packages are essentially ways for you to install and use functions 
written by others.
Occasionally, some of these functions have the same name and there is a conflict.
Whichever package you load more recently using `library` will mask the old function, meaning that R will default to that version.

In general, this is fine, especially with `tidyverse`. These package authors know when 
they have masked common functions in R, and typically we will prefer `tidyverse` version.

The conflict message is to make sure you know about conflicts. 
You can (and should) hide this in your R Markdown files by adding the parameter
`message=FALSE` or `include=FALSE` to your code chunk when you load packages.

---
layout: false
layout: true

# Pipes
---

.sectionhead[![pipe](pipe.png)]

---

**pipes** use the `%&gt;%` operator to take the output from a previous function call and ``pipe'' it through to the next function.
This can really help with readability of code when we use multiple nested functions!

We will use the `gapminder` data from Jenny Bryan to demonstrate throughout this section.
Load the package `gapminder` (after installing) and the corresponding data.


```r
library(gapminder)
data(gapminder)
```

Let's preview the data.


```r
gapminder
```

```
## # A tibble: 1,704 x 6
##    country     continent  year lifeExp      pop gdpPercap
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1 Afghanistan Asia       1952    28.8  8425333      779.
##  2 Afghanistan Asia       1957    30.3  9240934      821.
##  3 Afghanistan Asia       1962    32.0 10267083      853.
##  4 Afghanistan Asia       1967    34.0 11537966      836.
##  5 Afghanistan Asia       1972    36.1 13079460      740.
##  6 Afghanistan Asia       1977    38.4 14880372      786.
##  7 Afghanistan Asia       1982    39.9 12881816      978.
##  8 Afghanistan Asia       1987    40.8 13867957      852.
##  9 Afghanistan Asia       1992    41.7 16317921      649.
## 10 Afghanistan Asia       1997    41.8 22227415      635.
## # … with 1,694 more rows
```

---

## A brief note on factors


```r
str(gapminder)
```

```
## Classes 'tbl_df', 'tbl' and 'data.frame':	1704 obs. of  6 variables:
##  $ country  : Factor w/ 142 levels "Afghanistan",..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ continent: Factor w/ 5 levels "Africa","Americas",..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
##  $ lifeExp  : num  28.8 30.3 32 34 36.1 ...
##  $ pop      : int  8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...
##  $ gdpPercap: num  779 821 853 836 740 ...
```

**factors** are categorical data that use integer representation.

This can be efficient to store character vectors, because each string is only entered once. 
Because of this, creating data frames (but not tibbles!) in R often default to set strings as factors. 
However, it can also get annoying! 
Factors limit the categories, or `levels`, of the vector, which is often not appropriate.
I usually turn this off by setting the parameter `stringsAsFactors = FALSE` when I use `data.frame()`, unless I specifically want my data encoded as categorical.

---

## Functions in Functions

What if we want the mean log population within our data set? 
Using base R, we might type


```r
mean(log(gapminder$pop))
```

```
## [1] 15.76611
```

With pipes, we can use


```r
gapminder$pop %&gt;%
  log() %&gt;%
  mean()
```

```
## [1] 15.76611
```

Both of these are acceptable. However, when we start adding more and more functions,
pipes can make your code much easier and more natural to read.

---
layout: false

# filtering data

Very commonly, we will want to filter our data to restrict what we plot or analyze.
For example, what if we are only interested in data from China since 1970?


```r
china_1980 &lt;- gapminder %&gt;% 
  filter(country == "China" &amp;
           year &gt;= 1970)
china_1980
```

```
## # A tibble: 8 x 6
##   country continent  year lifeExp        pop gdpPercap
##   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;      &lt;int&gt;     &lt;dbl&gt;
## 1 China   Asia       1972    63.1  862030000      677.
## 2 China   Asia       1977    64.0  943455000      741.
## 3 China   Asia       1982    65.5 1000281000      962.
## 4 China   Asia       1987    67.3 1084035000     1379.
## 5 China   Asia       1992    68.7 1164970000     1656.
## 6 China   Asia       1997    70.4 1230075000     2289.
## 7 China   Asia       2002    72.0 1280400000     3119.
## 8 China   Asia       2007    73.0 1318683096     4959.
```

---
class: inverse

.sectionhead[Part 2: Data Visualization]
---
layout: true

# Data Visualization
---

`ggplot2` is a fantastic way to make complex publication quality&lt;sup&gt;1&lt;/sup&gt; images
without much pre-processing of your data.
Plots are built sequentially using layers, so it's easy to edit and fine-tune the plots you generate.

When using `ggplot2`, it is *essential* that your data are tidy!
If they are not, the functions probably will not look like you expect.

Let's work through how to build a plot layer by layer.

.footnote[[1] or STAT302 Project quality]

---

First, let's initialize a plot. Use the `data` parameter to tell `ggplot` what data frame to use.

* It should be tidy data, in either a `data.frame` or `tibble`!

.pull-left[

```r
*ggplot(data = gapminder)
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;
]

---

Add an aesthetic using the function `aes()` within the initial `ggplot()` call.

* Controls our axes variables as well as graphical parameters such as color, size, shape

.pull-left[

```r
ggplot(data = gapminder,
*      aes(x = year, y = lifeExp))
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;
]

---

Now `ggplot` knows what to plot, but it doesn't know how to plot it yet. Let's add some points with `geom_point()`.

* This is a new layer! We add layers using the `+` operator.


.pull-left[

```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp)) +
* geom_point()
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;
]

---

Let's make our points smaller and red.

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp)) +
* geom_point(color = "red", size = 0.75)
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;
]

---

Let's try switching them to lines.

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp)) +
* geom_line(color = "red", size = 0.75)
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-18-1.png)&lt;!-- --&gt;
]

---

We want lines connected by country, not just in the order they appear in the data.

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
*          group = country)) +
  geom_line(color = "red", size = 0.5) 
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-20-1.png)&lt;!-- --&gt;
]

---

We want to explore differences across continents, so let's color by continent

* We use `aes()` because we want to color by something in our data
* Putting a color within `aes()` will automatically add a label
* We have to remove the color within `geom_line()`, or it will override the `aes()`


.pull-left[

```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
*          color = continent)) +
* geom_line(size = 0.5)
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-22-1.png)&lt;!-- --&gt;
]

---

Let's add another layer. Trendlines by continent!

* We want them grouped differently than our lines (by continent), so we use a new `aes()`
* We will make them stick out by having them be thicker and black
* We don't want error bars, so we will remove `se`
* We will use the default option `loess`. (See `?geom_smooth()`)

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
* geom_smooth(aes(group = continent),
*             se = FALSE, size = 1.5,
*             color = "black",
*             method = "loess")
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-24-1.png)&lt;!-- --&gt;
]

---


This is cluttered and hard to read. Let's try separating by continents using **facets**!

* We use `facet_wrap` 
* Takes in a **formula** object. Use a tilde `~` and then the variable name you want

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, 
              color = "black", 
              method = "loess") +
* facet_wrap(~ continent)
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-26-1.png)&lt;!-- --&gt;
]

---

Looking better! Now let's fine tune. First we'll formalize the labels on our plot using `labs()`.

* Can also edit labels one at a time using `xlab()`, `ylab()`, `ggmain()`, ...
* You should probably do this in every graph you present! Very rarely do you want the text styling of your data frame to match your output. Emphasis here on human readability!


```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, 
              color = "black", 
              method = "loess") +
  facet_wrap(~ continent) +
* labs(title = "Life expectancy over time by continent",
*      x = "Year", y = "Life Expectancy",
*      legend = "Continent")
```

---

![](lectureslides3_files/figure-html/unnamed-chunk-28-1.png)&lt;!-- --&gt;


---

Let's center our title by adjusting `theme()`.

* `element_text()` tells ggplot how to display the text. Used for fine-tuning
* `hjust` is our horizontal alignment, we set it to one half



```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, color = "black", method = "loess") +
  facet_wrap(~ continent) +
  labs(title = "Life expectancy over time by continent", 
       x = "Year", y = "Life Expectancy", legend = "Continent") +
* theme(plot.title = element_text(hjust = 0.5,
*                                 face = "bold",
*                                 size = 14))
```

---

.middler[
![](lectureslides3_files/figure-html/unnamed-chunk-30-1.png)&lt;!-- --&gt;
]

---

Actually, that legend is redundant. Let's remove it.


```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, color = "black", method = "loess") +
  facet_wrap(~ continent) +
  labs(title = "Life expectancy over time by continent", 
       x = "Year", y = "Life Expectancy") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
*       legend.position = "none")
```

---

.middler[
![](lectureslides3_files/figure-html/unnamed-chunk-32-1.png)&lt;!-- --&gt;
]

---

I don't like the default gray background. I almost always set the `theme_bw()`.

* There are several other theme options! Too many to list, so look them up if you want more options.


```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, color = "black", method = "loess") +
  facet_wrap(~ continent) +
  labs(title = "Life expectancy over time by continent", 
       x = "Year", y = "Life Expectancy") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
        legend.position = "none") +
* theme_bw()
```

---

.middler[
![](lectureslides3_files/figure-html/unnamed-chunk-34-1.png)&lt;!-- --&gt;
]

---

This overwrote our custome `theme()` settings! Let's reorder the layers.


```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, color = "black", method = "loess") +
  facet_wrap(~ continent) +
  labs(title = "Life expectancy over time by continent", 
       x = "Year", y = "Life Expectancy") +
* theme_bw() +
* theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
*       legend.position = "none")
```

---

.middler[
![](lectureslides3_files/figure-html/unnamed-chunk-36-1.png)&lt;!-- --&gt;
]

---

We can make this more readable. Be careful of text that is too small! 
Let's increase all of our text proportionally using `base_size` within `theme_bw()`.

* We could also do this by adjusting `text` within `theme()`
* Note that we no longer need to manually adjust our title size. This will scale everything automatically.


```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, color = "black", method = "loess") +
  facet_wrap(~ continent) +
  labs(title = "Life expectancy over time by continent", 
       x = "Year", y = "Life Expectancy") +
* theme_bw(base_size = 16) +
* theme(plot.title = element_text(hjust = 0.5, face = "bold"),
        legend.position = "none") 
```

---

.middler[
![](lectureslides3_files/figure-html/unnamed-chunk-38-1.png)&lt;!-- --&gt;
]


---

Almost there! Now our text is a good size, but it overlaps. There are a few ways we could fix this. We'll rotate our text.



```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, color = "black", method = "loess") +
  facet_wrap(~ continent) +
  labs(title = "Life expectancy over time by continent", 
       x = "Year", y = "Life Expectancy") +
  theme_bw(base_size = 16) + 
  theme(plot.title = element_text(hjust = 0.5, face = "bold"), 
        legend.position = "none",
*       axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
```

---

.middler[
![](lectureslides3_files/figure-html/unnamed-chunk-40-1.png)&lt;!-- --&gt;
]

---

Lastly, let's space out our panels by adjusting `panel.spacing.x`.


```r
ggplot(data = gapminder,
       aes(x = year, y = lifeExp,
           group = country,
           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, color = "black", method = "loess") +
  facet_wrap(~ continent) +
  labs(title = "Life expectancy over time by continent", 
       x = "Year", y = "Life Expectancy") +
  theme_bw(base_size = 16) + 
  theme(plot.title = element_text(hjust = 0.5, face = "bold"), 
        legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
*       panel.spacing.x = unit(0.75, "cm"))
```

---

.middler[
![](lectureslides3_files/figure-html/unnamed-chunk-42-1.png)&lt;!-- --&gt;
]

---

Great, that looks good! Now we can store it as an object.


```r
*lifeExp_plot &lt;- ggplot(data = gapminder,
                       aes(x = year, y = lifeExp,
                           group = country,
                           color = continent)) + 
  geom_line(size = 0.5) +
  geom_smooth(aes(group = continent), 
              se = FALSE, size = 1.5, color = "black", method = "loess") +
  facet_wrap(~ continent) +
  labs(title = "Life expectancy over time by continent", 
       x = "Year", y = "Life Expectancy") +
  theme_bw(base_size = 16) + 
  theme(plot.title = element_text(hjust = 0.5, face = "bold"), 
        legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        panel.spacing.x = unit(0.75, "cm")) 
```

---

Then we can plot it by just calling our object.


```r
lifeExp_plot
```

.center[
![](lectureslides3_files/figure-html/unnamed-chunk-45-1.png)&lt;!-- --&gt;
]

---


We can also save it in our `Figures` subfolder using `ggsave()`.

* Set `height` and `width` parameters to automatically resize the image



```r
ggsave(filename = "Figures/lifeExp_plot.pdf", plot = lifeExp_plot,
       height = 5, width = 7)
```

.center[**Never** save a figure from your analysis using screenshots or point-and-click!

They will be lower quality and non-reproducible!]

---

## Some comments on `ggplot`:

* What we just made was a *very* complicated and fine-tuned plot!
* I have to Google how to adjust certain things all the time
* So does the creator of `ggplot2`

.center[![hadley](hadley.png)]

---

## A simpler example: Histogram

.pull-left[

```r
*ggplot(data = gapminder,
*      aes(x = lifeExp))
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-48-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Histogram

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = lifeExp)) + 
* geom_histogram()
```
]

.pull-right[

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

![](lectureslides3_files/figure-html/unnamed-chunk-50-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Histogram

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = lifeExp)) + 
* geom_histogram(binwidth = 1)
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-52-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Histogram

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = lifeExp)) + 
  geom_histogram(binwidth = 1, 
*                color = "black",
*                fill = "lightblue")
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-54-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Histogram

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = lifeExp)) + 
  geom_histogram(binwidth = 1, 
                 color = "black", 
                 fill = "lightblue") +
* theme_bw(base_size = 20)
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-56-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Histogram

.pull-left[

```r
ggplot(data = gapminder,
       aes(x = lifeExp)) + 
  geom_histogram(binwidth = 1, 
                 color = "black", 
                 fill = "lightblue") +
  theme_bw(base_size = 20) +
* labs(x = "Life Expectancy",
*      y = "Count")
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-58-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Boxplots

.pull-left[

```r
*ggplot(data = gapminder,
*      aes(x = continent, y = lifeExp))
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-60-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Boxplots

.pull-left[

```r
ggplot(data = gapminder, 
       aes(x = continent, y = lifeExp)) +
* geom_boxplot()
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-62-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Boxplots

.pull-left[

```r
ggplot(data = gapminder, 
       aes(x = continent, y = lifeExp)) +
* geom_boxplot(fill = "lightblue")
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-64-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Boxplots

.pull-left[

```r
ggplot(data = gapminder, 
       aes(x = continent, y = lifeExp)) +
  geom_boxplot(fill = "lightblue") +
* theme_bw(base_size = 20)
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-66-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Boxplots

.pull-left[

```r
ggplot(data = gapminder, 
       aes(x = continent, y = lifeExp)) +
  geom_boxplot(fill = "lightblue") +
  theme_bw(base_size = 20) +
* labs(title = "Life expectancy by Continent",
*      x = "",
*      y = "")
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-68-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Boxplots

.pull-left[

```r
ggplot(data = gapminder, 
       aes(x = continent, y = lifeExp)) +
  geom_boxplot(fill = "lightblue") +
  theme_bw(base_size = 20) +
  labs(title = "Life expectancy by Continent", 
       x = "", 
       y = "") +
* theme(plot.title =
*         element_text(hjust = 0.5))
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-70-1.png)&lt;!-- --&gt;
]

---

## A simpler example: Boxplots

.pull-left[

```r
ggplot(data = gapminder, 
       aes(x = continent, y = lifeExp)) +
  geom_boxplot(fill = "lightblue") +
  theme_bw(base_size = 20) +
  labs(title = "Life expectancy by Continent", 
       x = "", 
       y = "") +
  theme(plot.title =
          element_text(hjust = 0.5)) +
* ylim(c(0, 85))
```
]

.pull-right[
![](lectureslides3_files/figure-html/unnamed-chunk-72-1.png)&lt;!-- --&gt;
]

---

.pull-left[## Don'ts
* Pie graphs, ever
* 3D plots
* Deceptive axes
* Excessive labels
* Excessive/bad coloring
* Fancy shading/effects
* Bad variable/axis names
* Unreadable labels
* Overloaded with information
]

.pull-right[## Do's
* Simple, clean graphics
* Neat and human readable text
* Appropriate data range (bar charts should *always* start from 0!)
* Consistent intervals
* Roughly ~6 colors or less
* Size figures appropriately
]

---
layout: false
layout: true

# Bad Visualizations!

---

.center[&lt;img src="bad1.jpg" alt="" height="300"/&gt;]

--

**No-no:** Pie charts! Eugh! The proportions are completely off!
.pull-right[.center[&lt;img src="gag1.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad2.jpg" alt="" height="300"/&gt;]

--

**No-no:** Pie charts! Eugh! Percents don't add up!
.pull-right[.center[&lt;img src="gag2.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad3.png" alt="" height="300"/&gt;]

--

**No-no:** 3d bar charts?!
.pull-right[.center[&lt;img src="gag3.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad4.png" alt="" height="300"/&gt;]

--

**No-no:** Bad use of color
.pull-right[.center[&lt;img src="gag4.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad5.jpg" alt="" height="300"/&gt;]

--

**No-no:** Bad axis, lack of information, 3D bar chart
.pull-right[.center[&lt;img src="gag5.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad6.jpg" alt="" height="300"/&gt;]

--

**No-no:** Four numbers displayed as a cluttered chart, terrible labels, bad axis range
.pull-right[.center[&lt;img src="gag6.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad7.jpg" alt="" height="300"/&gt;]

--

**No-no:** Deceptively flipped y-axis! (and excessive color)
.pull-right[.center[&lt;img src="gag7.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad8.jpg" alt="" height="300"/&gt;]
.center[(This was presented in congress!)]

--

**No-no:** Two axes in a single plot, bad axis range
.pull-right[.center[&lt;img src="gag8.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad9.png" alt="" height="300"/&gt;]

--

**No-no:** Deceptive axis range (should start at 0)
.pull-right[.center[&lt;img src="gag9.gif" alt="" height="200"/&gt;]]

---

.center[&lt;img src="bad10.png" alt="" height="300"/&gt;]
.center[(From the Gates Foundation!)]

--

**No-no:** Inconsistent x-axis intervals
.pull-right[.center[&lt;img src="gag10.gif" alt="" height="200"/&gt;]]

---
layout: false

# ggplot cheatsheet

* Axes: `xlim()`, `ylim()`
* Legends: within initial `aes()`, edit within `theme()` or `guides()`
* `geom_point()`, `geom_line()`, `geom_histogram()`, `geom_bar()`, `geom_boxplot()`, `geom_text()`
* `facet_grid()`, `facet_wrap()` for faceting
* `labs()` for labels
* `theme_bw()` to make things look nicer
* Graphical parameters: `color` for color, `alpha` for opacity, `lwd`/`size` for thickness, `shape` for shape, `fill` for interior color, ...

.pushdown[.center[[Much, much more! (Click me for a cheatsheet!)](https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf)]]

---
class: inverse

.sectionhead[Part 3: Data Manipulation]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "tomorrow-night-bright",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
